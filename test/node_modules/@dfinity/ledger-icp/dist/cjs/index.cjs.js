"use strict";var rt=Object.create;var z=Object.defineProperty;var nt=Object.getOwnPropertyDescriptor;var ct=Object.getOwnPropertyNames;var ot=Object.getPrototypeOf,at=Object.prototype.hasOwnProperty;var st=(e,t)=>{for(var r in t)z(e,r,{get:t[r],enumerable:!0})},qe=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of ct(t))!at.call(e,o)&&o!==r&&z(e,o,{get:()=>t[o],enumerable:!(n=nt(t,o))||n.enumerable});return e};var it=(e,t,r)=>(r=e!=null?rt(ot(e)):{},qe(t||!e||!e.__esModule?z(r,"default",{value:e,enumerable:!0}):r,e)),ut=e=>qe(z({},"__esModule",{value:!0}),e);var At={};st(At,{AccountIdentifier:()=>F,BadFeeError:()=>j,IndexCanister:()=>I,InsufficientFundsError:()=>C,InvalidAccountIDError:()=>U,InvalidSenderError:()=>Y,LedgerCanister:()=>L,SubAccount:()=>W,TransferError:()=>T,TxCreatedInFutureError:()=>q,TxDuplicateError:()=>H,TxTooOldError:()=>S,accountIdentifierFromBytes:()=>bt,accountIdentifierToBytes:()=>gt,checkAccountId:()=>Tt,mapIcrc1TransferError:()=>Ve,mapTransferError:()=>Ee,mapTransferProtoError:()=>ve,principalToAccountIdentifier:()=>Rt});module.exports=ut(At);var B=require("@dfinity/utils");function dt(e){return e instanceof Uint8Array||e!=null&&typeof e=="object"&&e.constructor.name==="Uint8Array"}function pt(e,...t){if(!dt(e))throw new Error("Expected Uint8Array");if(t.length>0&&!t.includes(e.length))throw new Error(`Expected Uint8Array of length ${t}, not of length=${e.length}`)}function we(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function He(e,t){pt(e);let r=t.outputLen;if(e.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}function lt(e){return e instanceof Uint8Array||e!=null&&typeof e=="object"&&e.constructor.name==="Uint8Array"}var X=e=>new DataView(e.buffer,e.byteOffset,e.byteLength),R=(e,t)=>e<<32-t|e>>>t,ft=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!ft)throw new Error("Non little-endian hardware is not supported");function mt(e){if(typeof e!="string")throw new Error(`utf8ToBytes expected string, got ${typeof e}`);return new Uint8Array(new TextEncoder().encode(e))}function Oe(e){if(typeof e=="string"&&(e=mt(e)),!lt(e))throw new Error(`expected Uint8Array, got ${typeof e}`);return e}var Q=class{clone(){return this._cloneInto()}},Ot={}.toString;function Ge(e){let t=n=>e().update(Oe(n)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function _t(e,t,r,n){if(typeof e.setBigUint64=="function")return e.setBigUint64(t,r,n);let o=BigInt(32),c=BigInt(4294967295),a=Number(r>>o&c),u=Number(r&c),d=n?4:0,p=n?0:4;e.setUint32(t+d,a,n),e.setUint32(t+p,u,n)}var J=class extends Q{constructor(t,r,n,o){super(),this.blockLen=t,this.outputLen=r,this.padOffset=n,this.isLE=o,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=X(this.buffer)}update(t){we(this);let{view:r,buffer:n,blockLen:o}=this;t=Oe(t);let c=t.length;for(let a=0;a<c;){let u=Math.min(o-this.pos,c-a);if(u===o){let d=X(t);for(;o<=c-a;a+=o)this.process(d,a);continue}n.set(t.subarray(a,a+u),this.pos),this.pos+=u,a+=u,this.pos===o&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){we(this),He(t,this),this.finished=!0;let{buffer:r,view:n,blockLen:o,isLE:c}=this,{pos:a}=this;r[a++]=128,this.buffer.subarray(a).fill(0),this.padOffset>o-a&&(this.process(n,0),a=0);for(let s=a;s<o;s++)r[s]=0;_t(n,o-8,BigInt(this.length*8),c),this.process(n,0);let u=X(t),d=this.outputLen;if(d%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let p=d/4,m=this.get();if(p>m.length)throw new Error("_sha2: outputLen bigger than state");for(let s=0;s<p;s++)u.setUint32(4*s,m[s],c)}digest(){let{buffer:t,outputLen:r}=this;this.digestInto(t);let n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:r,buffer:n,length:o,finished:c,destroyed:a,pos:u}=this;return t.length=o,t.pos=u,t.finished=c,t.destroyed=a,o%r&&t.buffer.set(n),t}};var xt=(e,t,r)=>e&t^~e&r,yt=(e,t,r)=>e&t^e&r^t&r,ht=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),N=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),w=new Uint32Array(64),Fe=class extends J{constructor(){super(64,32,8,!1),this.A=N[0]|0,this.B=N[1]|0,this.C=N[2]|0,this.D=N[3]|0,this.E=N[4]|0,this.F=N[5]|0,this.G=N[6]|0,this.H=N[7]|0}get(){let{A:t,B:r,C:n,D:o,E:c,F:a,G:u,H:d}=this;return[t,r,n,o,c,a,u,d]}set(t,r,n,o,c,a,u,d){this.A=t|0,this.B=r|0,this.C=n|0,this.D=o|0,this.E=c|0,this.F=a|0,this.G=u|0,this.H=d|0}process(t,r){for(let s=0;s<16;s++,r+=4)w[s]=t.getUint32(r,!1);for(let s=16;s<64;s++){let l=w[s-15],_=w[s-2],y=R(l,7)^R(l,18)^l>>>3,f=R(_,17)^R(_,19)^_>>>10;w[s]=f+w[s-7]+y+w[s-16]|0}let{A:n,B:o,C:c,D:a,E:u,F:d,G:p,H:m}=this;for(let s=0;s<64;s++){let l=R(u,6)^R(u,11)^R(u,25),_=m+l+xt(u,d,p)+ht[s]+w[s]|0,f=(R(n,2)^R(n,13)^R(n,22))+yt(n,o,c)|0;m=p,p=d,d=u,u=a+_|0,a=c,c=o,o=n,n=_+f|0}n=n+this.A|0,o=o+this.B|0,c=c+this.C|0,a=a+this.D|0,u=u+this.E|0,d=d+this.F|0,p=p+this.G|0,m=m+this.H|0,this.set(n,o,c,a,u,d,p,m)}roundClean(){w.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}},Be=class extends Fe{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}};var K=Ge(()=>new Be);var ke=require("@dfinity/agent"),O=()=>import("@dfinity/nns-proto"),Me=async({agent:e,canisterId:t,methodName:r,arg:n})=>{let o=await e.call(t,{methodName:r,arg:n,effectiveCanisterId:t});if(!o.response.ok)throw new Error(["Call failed:",`  Method: ${r}`,`  Canister ID: ${t}`,`  Request ID: ${o.requestId}`,`  HTTP status code: ${o.response.status}`,`  HTTP status text: ${o.response.statusText}`].join(`
`));let c=await ke.polling.pollForResponse(e,t,o.requestId,ke.polling.defaultStrategy());return new Uint8Array(c)},$e=async({agent:e,canisterId:t,methodName:r,arg:n})=>{let o=await e.query(t,{methodName:r,arg:n});if(o.status=="rejected")throw new Error(["Call failed:",`  Method: ${r}`,`  Canister ID: ${t}`,`  HTTP status code: ${o.reject_code}`,`  HTTP status text: ${o.reject_message}`].join(`
`));return new Uint8Array(o.reply.arg)};var F=class e{constructor(t){this.bytes=t}static fromHex(t){return new e(Uint8Array.from(Buffer.from(t,"hex")))}static fromPrincipal({principal:t,subAccount:r=W.fromID(0)}){let n=(0,B.asciiStringToByteArray)(`
account-id`),o=K.create();o.update((0,B.arrayOfNumberToUint8Array)([...n,...t.toUint8Array(),...r.toUint8Array()]));let c=o.digest(),a=(0,B.bigEndianCrc32)(c),u=new Uint8Array([...a,...c]);return new e(u)}async toProto(){let{AccountIdentifier:t}=await O(),r=new t;return r.setHash(this.bytes),r}toHex(){return(0,B.uint8ArrayToHexString)(this.bytes)}toUint8Array(){return this.bytes}toNumbers(){return Array.from(this.bytes)}toAccountIdentifierHash(){return{hash:this.toUint8Array()}}},W=class e{constructor(t){this.bytes=t}static fromBytes(t){return t.length!=32?Error("Subaccount length must be 32-bytes"):new e(t)}static fromPrincipal(t){let r=new Uint8Array(32).fill(0),n=t.toUint8Array();r[0]=n.length;for(let o=0;o<n.length;o++)r[1+o]=n[o];return new e(r)}static fromID(t){if(t<0)throw new Error("Number cannot be negative");if(t>Number.MAX_SAFE_INTEGER)throw new Error("Number is too large to fit in 32 bytes.");let r=new DataView(new ArrayBuffer(32));if(typeof r.setBigUint64=="function")r.setBigUint64(24,BigInt(t));else{let o=BigInt(1)<<BigInt(32);r.setUint32(24,Number(BigInt(t)>>BigInt(32))),r.setUint32(28,Number(BigInt(t)%o))}let n=new Uint8Array(r.buffer);return new e(n)}toUint8Array(){return this.bytes}};var We=require("@dfinity/utils"),T=class extends Error{},Y=class extends T{},U=class extends Error{},C=class extends T{constructor(r){super();this.balance=r}},S=class extends T{constructor(r){super();this.allowed_window_secs=r}},q=class extends T{},H=class extends T{constructor(r){super();this.duplicateOf=r}},j=class extends T{constructor(r){super();this.expectedFee=r}},Ee=e=>"TxDuplicate"in e?new H(e.TxDuplicate.duplicate_of):"InsufficientFunds"in e?new C(e.InsufficientFunds.balance.e8s):"TxCreatedInFuture"in e?new q:"TxTooOld"in e?new S(Number(e.TxTooOld.allowed_window_nanos)):"BadFee"in e?new j(e.BadFee.expected_fee.e8s):new T(`Unknown error type ${JSON.stringify(e)}`),Ve=e=>"Duplicate"in e?new H(e.Duplicate.duplicate_of):"InsufficientFunds"in e?new C(e.InsufficientFunds.balance):"CreatedInFuture"in e?new q:"TooOld"in e?new S:"BadFee"in e?new j(e.BadFee.expected_fee):new T(`Unknown error type ${JSON.stringify(e)}`),ve=e=>{let{message:t}=e;if(t.includes("Reject code: 5")){if(t.match(/Sending from (.*) is not allowed/))return new Y;{let r=t.match(/transaction.*duplicate.* in block (\d+)/);if(r&&r.length>1)return new H(BigInt(r[1]))}{let r=t.match(/debit account.*, current balance: (\d*(\.\d*)?)/);if(r&&r.length>1){let n=(0,We.convertStringToE8s)(r[1]);if(typeof n=="bigint")return new C(n)}}if(t.includes("is in future"))return new q;{let r=t.match(/older than (\d+)/);if(r&&r.length>1)return new S(Number.parseInt(r[1]))}}throw e};var G=require("@dfinity/utils");var je=({IDL:e})=>{let t=e.Record({ledger_id:e.Principal}),r=e.Record({max_results:e.Nat64,start:e.Opt(e.Nat64),account_identifier:e.Text}),n=e.Record({e8s:e.Nat64}),o=e.Record({timestamp_nanos:e.Nat64}),c=e.Variant({Approve:e.Record({fee:n,from:e.Text,allowance:n,expected_allowance:e.Opt(n),expires_at:e.Opt(o),spender:e.Text}),Burn:e.Record({from:e.Text,amount:n,spender:e.Opt(e.Text)}),Mint:e.Record({to:e.Text,amount:n}),Transfer:e.Record({to:e.Text,fee:n,from:e.Text,amount:n,spender:e.Opt(e.Text)})}),a=e.Record({memo:e.Nat64,icrc1_memo:e.Opt(e.Vec(e.Nat8)),operation:c,created_at_time:e.Opt(o)}),u=e.Record({id:e.Nat64,transaction:a}),d=e.Record({balance:e.Nat64,transactions:e.Vec(u),oldest_tx_id:e.Opt(e.Nat64)}),p=e.Record({message:e.Text}),m=e.Variant({Ok:d,Err:p}),s=e.Record({owner:e.Principal,subaccount:e.Opt(e.Vec(e.Nat8))}),l=e.Record({max_results:e.Nat,start:e.Opt(e.Nat),account:s}),_=e.Record({start:e.Nat,length:e.Nat}),y=e.Record({blocks:e.Vec(e.Vec(e.Nat8)),chain_length:e.Nat64}),f=e.Record({url:e.Text,method:e.Text,body:e.Vec(e.Nat8),headers:e.Vec(e.Tuple(e.Text,e.Text))}),i=e.Record({body:e.Vec(e.Nat8),headers:e.Vec(e.Tuple(e.Text,e.Text)),status_code:e.Nat16}),E=e.Record({num_blocks_synced:e.Nat64});return e.Service({get_account_identifier_balance:e.Func([e.Text],[e.Nat64],[]),get_account_identifier_transactions:e.Func([r],[m],[]),get_account_transactions:e.Func([l],[m],[]),get_blocks:e.Func([_],[y],[]),http_request:e.Func([f],[i],[]),icrc1_balance_of:e.Func([s],[e.Nat64],[]),ledger_id:e.Func([],[e.Principal],[]),status:e.Func([],[E],[])})};var ze=({IDL:e})=>{let t=e.Record({ledger_id:e.Principal}),r=e.Record({max_results:e.Nat64,start:e.Opt(e.Nat64),account_identifier:e.Text}),n=e.Record({e8s:e.Nat64}),o=e.Record({timestamp_nanos:e.Nat64}),c=e.Variant({Approve:e.Record({fee:n,from:e.Text,allowance:n,expected_allowance:e.Opt(n),expires_at:e.Opt(o),spender:e.Text}),Burn:e.Record({from:e.Text,amount:n,spender:e.Opt(e.Text)}),Mint:e.Record({to:e.Text,amount:n}),Transfer:e.Record({to:e.Text,fee:n,from:e.Text,amount:n,spender:e.Opt(e.Text)})}),a=e.Record({memo:e.Nat64,icrc1_memo:e.Opt(e.Vec(e.Nat8)),operation:c,created_at_time:e.Opt(o)}),u=e.Record({id:e.Nat64,transaction:a}),d=e.Record({balance:e.Nat64,transactions:e.Vec(u),oldest_tx_id:e.Opt(e.Nat64)}),p=e.Record({message:e.Text}),m=e.Variant({Ok:d,Err:p}),s=e.Record({owner:e.Principal,subaccount:e.Opt(e.Vec(e.Nat8))}),l=e.Record({max_results:e.Nat,start:e.Opt(e.Nat),account:s}),_=e.Record({start:e.Nat,length:e.Nat}),y=e.Record({blocks:e.Vec(e.Vec(e.Nat8)),chain_length:e.Nat64}),f=e.Record({url:e.Text,method:e.Text,body:e.Vec(e.Nat8),headers:e.Vec(e.Tuple(e.Text,e.Text))}),i=e.Record({body:e.Vec(e.Nat8),headers:e.Vec(e.Tuple(e.Text,e.Text)),status_code:e.Nat16}),E=e.Record({num_blocks_synced:e.Nat64});return e.Service({get_account_identifier_balance:e.Func([e.Text],[e.Nat64],["query"]),get_account_identifier_transactions:e.Func([r],[m],["query"]),get_account_transactions:e.Func([l],[m],["query"]),get_blocks:e.Func([_],[y],["query"]),http_request:e.Func([f],[i],["query"]),icrc1_balance_of:e.Func([s],[e.Nat64],["query"]),ledger_id:e.Func([],[e.Principal],["query"]),status:e.Func([],[E],["query"])})};var Pe=require("@dfinity/principal"),Qe=Pe.Principal.fromText("ryjl3-tyaaa-aaaaa-aaaba-cai"),Xe=Pe.Principal.fromText("qhbym-qaaaa-aaaaa-aaafq-cai");var Z=class extends Error{};var Je=e=>e instanceof F?e:F.fromHex(e),Ue=e=>e instanceof F?e.toHex():e;var I=class e extends G.Canister{constructor(){super(...arguments);this.accountBalance=({certified:r,accountIdentifier:n})=>this.caller({certified:r}).get_account_identifier_balance(Ue(n));this.getTransactions=async({certified:r,accountIdentifier:n,start:o,maxResults:c})=>{let a=await this.caller({certified:r}).get_account_identifier_transactions({account_identifier:Ue(n),start:(0,G.toNullable)(o),max_results:c});if("Err"in a)throw new Z(a.Err.message);return a.Ok}}static create({canisterId:r,...n}){let{service:o,certifiedService:c,canisterId:a}=(0,G.createServices)({options:{...n,canisterId:r??Xe},idlFactory:ze,certifiedIdlFactory:je});return new e(a,o,c)}};var et=require("@dfinity/utils");var Ke=({IDL:e})=>{let t=e.Vec(e.Nat8),r=e.Record({owner:e.Principal,subaccount:e.Opt(t)}),n=e.Record({icrc2:e.Bool}),o=e.Record({maximum_number_of_accounts:e.Opt(e.Nat64),icrc1_minting_account:e.Opt(r),feature_flags:e.Opt(n)}),c=e.Record({e8s:e.Nat64}),a=e.Text,u=e.Record({secs:e.Nat64,nanos:e.Nat32}),d=e.Record({num_blocks_to_archive:e.Nat64,max_transactions_per_response:e.Opt(e.Nat64),trigger_threshold:e.Nat64,max_message_size_bytes:e.Opt(e.Nat64),cycles_for_archive_creation:e.Opt(e.Nat64),node_max_memory_size_bytes:e.Opt(e.Nat64),controller_id:e.Principal}),p=e.Record({send_whitelist:e.Vec(e.Principal),token_symbol:e.Opt(e.Text),transfer_fee:e.Opt(c),minting_account:a,maximum_number_of_accounts:e.Opt(e.Nat64),accounts_overflow_trim_quantity:e.Opt(e.Nat64),transaction_window:e.Opt(u),max_message_size_bytes:e.Opt(e.Nat64),icrc1_minting_account:e.Opt(r),archive_options:e.Opt(d),initial_values:e.Vec(e.Tuple(a,c)),token_name:e.Opt(e.Text),feature_flags:e.Opt(n)}),m=e.Variant({Upgrade:e.Opt(o),Init:p}),s=e.Vec(e.Nat8),l=e.Record({account:s}),_=e.Record({account:a}),y=e.Record({canister_id:e.Principal}),f=e.Record({archives:e.Vec(y)}),i=e.Nat,E=e.Variant({Int:e.Int,Nat:e.Nat,Blob:e.Vec(e.Nat8),Text:e.Text}),h=e.Nat64,D=e.Record({to:r,fee:e.Opt(i),memo:e.Opt(e.Vec(e.Nat8)),from_subaccount:e.Opt(t),created_at_time:e.Opt(h),amount:i}),g=e.Nat,ee=e.Variant({GenericError:e.Record({message:e.Text,error_code:e.Nat}),TemporarilyUnavailable:e.Null,BadBurn:e.Record({min_burn_amount:i}),Duplicate:e.Record({duplicate_of:g}),BadFee:e.Record({expected_fee:i}),CreatedInFuture:e.Record({ledger_time:e.Nat64}),TooOld:e.Null,InsufficientFunds:e.Record({balance:i})}),te=e.Variant({Ok:g,Err:ee}),re=e.Record({account:r,spender:r}),ne=e.Record({allowance:i,expires_at:e.Opt(h)}),ce=e.Record({fee:e.Opt(i),memo:e.Opt(e.Vec(e.Nat8)),from_subaccount:e.Opt(t),created_at_time:e.Opt(h),amount:i,expected_allowance:e.Opt(i),expires_at:e.Opt(h),spender:r}),oe=e.Variant({GenericError:e.Record({message:e.Text,error_code:e.Nat}),TemporarilyUnavailable:e.Null,Duplicate:e.Record({duplicate_of:g}),BadFee:e.Record({expected_fee:i}),AllowanceChanged:e.Record({current_allowance:i}),CreatedInFuture:e.Record({ledger_time:e.Nat64}),TooOld:e.Null,Expired:e.Record({ledger_time:e.Nat64}),InsufficientFunds:e.Record({balance:i})}),ae=e.Variant({Ok:g,Err:oe}),se=e.Record({to:r,fee:e.Opt(i),spender_subaccount:e.Opt(t),from:r,memo:e.Opt(e.Vec(e.Nat8)),created_at_time:e.Opt(h),amount:i}),ie=e.Variant({GenericError:e.Record({message:e.Text,error_code:e.Nat}),TemporarilyUnavailable:e.Null,InsufficientAllowance:e.Record({allowance:i}),BadBurn:e.Record({min_burn_amount:i}),Duplicate:e.Record({duplicate_of:g}),BadFee:e.Record({expected_fee:i}),CreatedInFuture:e.Record({ledger_time:h}),TooOld:e.Null,InsufficientFunds:e.Record({balance:i})}),ue=e.Variant({Ok:g,Err:ie}),x=e.Nat64,A=e.Record({start:x,length:e.Nat64}),V=e.Nat64,b=e.Record({timestamp_nanos:e.Nat64}),de=e.Variant({Approve:e.Record({fee:c,from:s,allowance_e8s:e.Int,allowance:c,expected_allowance:e.Opt(c),expires_at:e.Opt(b),spender:s}),Burn:e.Record({from:s,amount:c,spender:e.Opt(s)}),Mint:e.Record({to:s,amount:c}),Transfer:e.Record({to:s,fee:c,from:s,amount:c,spender:e.Opt(e.Vec(e.Nat8))})}),pe=e.Record({memo:V,icrc1_memo:e.Opt(e.Vec(e.Nat8)),operation:e.Opt(de),created_at_time:b}),M=e.Record({transaction:pe,timestamp:b,parent_hash:e.Opt(e.Vec(e.Nat8))}),le=e.Record({blocks:e.Vec(M)}),$=e.Variant({BadFirstBlockIndex:e.Record({requested_index:x,first_valid_index:x}),Other:e.Record({error_message:e.Text,error_code:e.Nat64})}),fe=e.Variant({Ok:le,Err:$}),me=e.Func([A],[fe],[]),_e=e.Record({callback:me,start:x,length:e.Nat64}),xe=e.Record({certificate:e.Opt(e.Vec(e.Nat8)),blocks:e.Vec(M),chain_length:e.Nat64,first_block_index:x,archived_blocks:e.Vec(_e)}),ye=e.Record({callback:e.Func([A],[e.Variant({Ok:e.Vec(e.Vec(e.Nat8)),Err:$})],[]),start:e.Nat64,length:e.Nat64}),he=e.Record({certificate:e.Opt(e.Vec(e.Nat8)),blocks:e.Vec(e.Vec(e.Nat8)),chain_length:e.Nat64,first_block_index:e.Nat64,archived_blocks:e.Vec(ye)}),ge=e.Record({to:a,fee:c,memo:V,from_subaccount:e.Opt(t),created_at_time:e.Opt(b),amount:c}),be=e.Record({to:s,fee:c,memo:V,from_subaccount:e.Opt(t),created_at_time:e.Opt(b),amount:c}),Re=e.Variant({TxTooOld:e.Record({allowed_window_nanos:e.Nat64}),BadFee:e.Record({expected_fee:c}),TxDuplicate:e.Record({duplicate_of:x}),TxCreatedInFuture:e.Null,InsufficientFunds:e.Record({balance:c})}),Te=e.Variant({Ok:x,Err:Re}),Ae=e.Record({}),Ne=e.Record({transfer_fee:c});return e.Service({account_balance:e.Func([l],[c],[]),account_balance_dfx:e.Func([_],[c],[]),account_identifier:e.Func([r],[s],[]),archives:e.Func([],[f],[]),decimals:e.Func([],[e.Record({decimals:e.Nat32})],[]),icrc1_balance_of:e.Func([r],[i],[]),icrc1_decimals:e.Func([],[e.Nat8],[]),icrc1_fee:e.Func([],[i],[]),icrc1_metadata:e.Func([],[e.Vec(e.Tuple(e.Text,E))],[]),icrc1_minting_account:e.Func([],[e.Opt(r)],[]),icrc1_name:e.Func([],[e.Text],[]),icrc1_supported_standards:e.Func([],[e.Vec(e.Record({url:e.Text,name:e.Text}))],[]),icrc1_symbol:e.Func([],[e.Text],[]),icrc1_total_supply:e.Func([],[i],[]),icrc1_transfer:e.Func([D],[te],[]),icrc2_allowance:e.Func([re],[ne],[]),icrc2_approve:e.Func([ce],[ae],[]),icrc2_transfer_from:e.Func([se],[ue],[]),name:e.Func([],[e.Record({name:e.Text})],[]),query_blocks:e.Func([A],[xe],[]),query_encoded_blocks:e.Func([A],[he],[]),send_dfx:e.Func([ge],[x],[]),symbol:e.Func([],[e.Record({symbol:e.Text})],[]),transfer:e.Func([be],[Te],[]),transfer_fee:e.Func([Ae],[Ne],[])})};var Ye=({IDL:e})=>{let t=e.Vec(e.Nat8),r=e.Record({owner:e.Principal,subaccount:e.Opt(t)}),n=e.Record({icrc2:e.Bool}),o=e.Record({maximum_number_of_accounts:e.Opt(e.Nat64),icrc1_minting_account:e.Opt(r),feature_flags:e.Opt(n)}),c=e.Record({e8s:e.Nat64}),a=e.Text,u=e.Record({secs:e.Nat64,nanos:e.Nat32}),d=e.Record({num_blocks_to_archive:e.Nat64,max_transactions_per_response:e.Opt(e.Nat64),trigger_threshold:e.Nat64,max_message_size_bytes:e.Opt(e.Nat64),cycles_for_archive_creation:e.Opt(e.Nat64),node_max_memory_size_bytes:e.Opt(e.Nat64),controller_id:e.Principal}),p=e.Record({send_whitelist:e.Vec(e.Principal),token_symbol:e.Opt(e.Text),transfer_fee:e.Opt(c),minting_account:a,maximum_number_of_accounts:e.Opt(e.Nat64),accounts_overflow_trim_quantity:e.Opt(e.Nat64),transaction_window:e.Opt(u),max_message_size_bytes:e.Opt(e.Nat64),icrc1_minting_account:e.Opt(r),archive_options:e.Opt(d),initial_values:e.Vec(e.Tuple(a,c)),token_name:e.Opt(e.Text),feature_flags:e.Opt(n)}),m=e.Variant({Upgrade:e.Opt(o),Init:p}),s=e.Vec(e.Nat8),l=e.Record({account:s}),_=e.Record({account:a}),y=e.Record({canister_id:e.Principal}),f=e.Record({archives:e.Vec(y)}),i=e.Nat,E=e.Variant({Int:e.Int,Nat:e.Nat,Blob:e.Vec(e.Nat8),Text:e.Text}),h=e.Nat64,D=e.Record({to:r,fee:e.Opt(i),memo:e.Opt(e.Vec(e.Nat8)),from_subaccount:e.Opt(t),created_at_time:e.Opt(h),amount:i}),g=e.Nat,ee=e.Variant({GenericError:e.Record({message:e.Text,error_code:e.Nat}),TemporarilyUnavailable:e.Null,BadBurn:e.Record({min_burn_amount:i}),Duplicate:e.Record({duplicate_of:g}),BadFee:e.Record({expected_fee:i}),CreatedInFuture:e.Record({ledger_time:e.Nat64}),TooOld:e.Null,InsufficientFunds:e.Record({balance:i})}),te=e.Variant({Ok:g,Err:ee}),re=e.Record({account:r,spender:r}),ne=e.Record({allowance:i,expires_at:e.Opt(h)}),ce=e.Record({fee:e.Opt(i),memo:e.Opt(e.Vec(e.Nat8)),from_subaccount:e.Opt(t),created_at_time:e.Opt(h),amount:i,expected_allowance:e.Opt(i),expires_at:e.Opt(h),spender:r}),oe=e.Variant({GenericError:e.Record({message:e.Text,error_code:e.Nat}),TemporarilyUnavailable:e.Null,Duplicate:e.Record({duplicate_of:g}),BadFee:e.Record({expected_fee:i}),AllowanceChanged:e.Record({current_allowance:i}),CreatedInFuture:e.Record({ledger_time:e.Nat64}),TooOld:e.Null,Expired:e.Record({ledger_time:e.Nat64}),InsufficientFunds:e.Record({balance:i})}),ae=e.Variant({Ok:g,Err:oe}),se=e.Record({to:r,fee:e.Opt(i),spender_subaccount:e.Opt(t),from:r,memo:e.Opt(e.Vec(e.Nat8)),created_at_time:e.Opt(h),amount:i}),ie=e.Variant({GenericError:e.Record({message:e.Text,error_code:e.Nat}),TemporarilyUnavailable:e.Null,InsufficientAllowance:e.Record({allowance:i}),BadBurn:e.Record({min_burn_amount:i}),Duplicate:e.Record({duplicate_of:g}),BadFee:e.Record({expected_fee:i}),CreatedInFuture:e.Record({ledger_time:h}),TooOld:e.Null,InsufficientFunds:e.Record({balance:i})}),ue=e.Variant({Ok:g,Err:ie}),x=e.Nat64,A=e.Record({start:x,length:e.Nat64}),V=e.Nat64,b=e.Record({timestamp_nanos:e.Nat64}),de=e.Variant({Approve:e.Record({fee:c,from:s,allowance_e8s:e.Int,allowance:c,expected_allowance:e.Opt(c),expires_at:e.Opt(b),spender:s}),Burn:e.Record({from:s,amount:c,spender:e.Opt(s)}),Mint:e.Record({to:s,amount:c}),Transfer:e.Record({to:s,fee:c,from:s,amount:c,spender:e.Opt(e.Vec(e.Nat8))})}),pe=e.Record({memo:V,icrc1_memo:e.Opt(e.Vec(e.Nat8)),operation:e.Opt(de),created_at_time:b}),M=e.Record({transaction:pe,timestamp:b,parent_hash:e.Opt(e.Vec(e.Nat8))}),le=e.Record({blocks:e.Vec(M)}),$=e.Variant({BadFirstBlockIndex:e.Record({requested_index:x,first_valid_index:x}),Other:e.Record({error_message:e.Text,error_code:e.Nat64})}),fe=e.Variant({Ok:le,Err:$}),me=e.Func([A],[fe],["query"]),_e=e.Record({callback:me,start:x,length:e.Nat64}),xe=e.Record({certificate:e.Opt(e.Vec(e.Nat8)),blocks:e.Vec(M),chain_length:e.Nat64,first_block_index:x,archived_blocks:e.Vec(_e)}),ye=e.Record({callback:e.Func([A],[e.Variant({Ok:e.Vec(e.Vec(e.Nat8)),Err:$})],["query"]),start:e.Nat64,length:e.Nat64}),he=e.Record({certificate:e.Opt(e.Vec(e.Nat8)),blocks:e.Vec(e.Vec(e.Nat8)),chain_length:e.Nat64,first_block_index:e.Nat64,archived_blocks:e.Vec(ye)}),ge=e.Record({to:a,fee:c,memo:V,from_subaccount:e.Opt(t),created_at_time:e.Opt(b),amount:c}),be=e.Record({to:s,fee:c,memo:V,from_subaccount:e.Opt(t),created_at_time:e.Opt(b),amount:c}),Re=e.Variant({TxTooOld:e.Record({allowed_window_nanos:e.Nat64}),BadFee:e.Record({expected_fee:c}),TxDuplicate:e.Record({duplicate_of:x}),TxCreatedInFuture:e.Null,InsufficientFunds:e.Record({balance:c})}),Te=e.Variant({Ok:x,Err:Re}),Ae=e.Record({}),Ne=e.Record({transfer_fee:c});return e.Service({account_balance:e.Func([l],[c],["query"]),account_balance_dfx:e.Func([_],[c],["query"]),account_identifier:e.Func([r],[s],["query"]),archives:e.Func([],[f],["query"]),decimals:e.Func([],[e.Record({decimals:e.Nat32})],["query"]),icrc1_balance_of:e.Func([r],[i],["query"]),icrc1_decimals:e.Func([],[e.Nat8],["query"]),icrc1_fee:e.Func([],[i],["query"]),icrc1_metadata:e.Func([],[e.Vec(e.Tuple(e.Text,E))],["query"]),icrc1_minting_account:e.Func([],[e.Opt(r)],["query"]),icrc1_name:e.Func([],[e.Text],["query"]),icrc1_supported_standards:e.Func([],[e.Vec(e.Record({url:e.Text,name:e.Text}))],["query"]),icrc1_symbol:e.Func([],[e.Text],["query"]),icrc1_total_supply:e.Func([],[i],["query"]),icrc1_transfer:e.Func([D],[te],[]),icrc2_allowance:e.Func([re],[ne],["query"]),icrc2_approve:e.Func([ce],[ae],[]),icrc2_transfer_from:e.Func([se],[ue],[]),name:e.Func([],[e.Record({name:e.Text})],["query"]),query_blocks:e.Func([A],[xe],["query"]),query_encoded_blocks:e.Func([A],[he],["query"]),send_dfx:e.Func([ge],[x],[]),symbol:e.Func([],[e.Record({symbol:e.Text})],["query"]),transfer:e.Func([be],[Te],[]),transfer_fee:e.Func([Ae],[Ne],["query"])})};var P=require("@dfinity/utils");var Dt=BigInt(1095062083),er=BigInt(1347768404),v=BigInt(1e4),tr=BigInt(1e8);var Ie=async e=>{let t=new Uint8Array(e).buffer,{Subaccount:r}=await O(),n=new r;return n.setSubAccount(new Uint8Array(t)),n},Ce=async e=>{let{ICPTs:t}=await O(),r=new t;return r.setE8s(e.toString(10)),r},Ze=e=>({e8s:e}),Le=({to:e,amount:t,memo:r,fee:n,fromSubAccount:o,createdAt:c})=>({to:e.toUint8Array(),fee:Ze(n??v),amount:Ze(t),memo:r??BigInt(0),created_at_time:c!==void 0?[{timestamp_nanos:c}]:[],from_subaccount:o===void 0?[]:[(0,P.arrayOfNumberToUint8Array)(o)]}),De=({fromSubAccount:e,to:t,amount:r,fee:n,icrc1Memo:o,createdAt:c})=>({to:t,fee:(0,P.toNullable)(n??v),amount:r,memo:(0,P.toNullable)(o),created_at_time:(0,P.toNullable)(c),from_subaccount:(0,P.toNullable)(e)});var L=class e{constructor(t,r,n,o,c,a,u=!1){this.agent=t;this.canisterId=r;this.service=n;this.certifiedService=o;this.updateFetcher=c;this.queryFetcher=a;this.hardwareWallet=u;this.accountBalance=async({accountIdentifier:t,certified:r=!0})=>{let n=Je(t);return this.hardwareWallet?this.accountBalanceHardwareWallet({accountIdentifier:n,certified:r}):(await(r?this.certifiedService:this.service).account_balance({account:n.toUint8Array()})).e8s};this.transactionFee=async()=>{let{transfer_fee:{e8s:t}}=await this.service.transfer_fee({});return t};this.transfer=async t=>{if(this.hardwareWallet)return this.transferHardwareWallet(t);t.fee===void 0&&(t.fee=this.hardwareWallet?v:await this.transactionFee());let r=Le(t),n=await this.certifiedService.transfer(r);if("Err"in n)throw Ee(n.Err);return n.Ok};this.icrc1Transfer=async t=>{t.fee===void 0&&(t.fee=this.hardwareWallet?v:await this.transactionFee());let r=De(t),n=await this.certifiedService.icrc1_transfer(r);if("Err"in n)throw Ve(n.Err);return n.Ok};this.accountBalanceHardwareWallet=async({accountIdentifier:t,certified:r=!0})=>{let n=r?this.updateFetcher:this.queryFetcher,{AccountBalanceRequest:o,ICPTs:c}=await O(),a=new o;a.setAccount(await t.toProto());let u=await n({agent:this.agent,canisterId:this.canisterId,methodName:"account_balance_pb",arg:a.serializeBinary()});return BigInt(c.deserializeBinary(new Uint8Array(u)).getE8s())};this.transferHardwareWallet=async({to:t,amount:r,memo:n,fee:o,fromSubAccount:c,createdAt:a})=>{let{SendRequest:u,Payment:d,Memo:p,TimeStamp:m,BlockHeight:s}=await O(),l=new u;l.setTo(await t.toProto());let _=new d;_.setReceiverGets(await Ce(r)),l.setPayment(_),l.setMaxFee(await Ce(o??v));let y=new p;if(y.setMemo((n??BigInt(0)).toString()),l.setMemo(y),a!==void 0){let f=new m;f.setTimestampNanos(a.toString()),l.setCreatedAtTime(f)}c!==void 0&&l.setFromSubaccount(await Ie(c));try{let f=await this.updateFetcher({agent:this.agent,canisterId:this.canisterId,methodName:"send_pb",arg:l.serializeBinary()});return BigInt(s.deserializeBinary(f).getHeight())}catch(f){throw f instanceof Error?ve(f):f}}}static create(t={}){let r=t.canisterId??Qe,{service:n,certifiedService:o,agent:c}=(0,et.createServices)({options:{...t,canisterId:r},idlFactory:Ye,certifiedIdlFactory:Ke});return new e(c,r,n,o,t.updateCallOverride??Me,t.queryCallOverride??$e,t.hardwareWallet)}};var k=require("@dfinity/utils");var Se=require("buffer"),gt=e=>Uint8Array.from(Se.Buffer.from(e,"hex")).subarray(4),bt=e=>Se.Buffer.from(e).toString("hex"),Rt=(e,t)=>{let r=(0,k.asciiStringToByteArray)(`
account-id`),n=K.create();n.update((0,k.arrayOfNumberToUint8Array)([...r,...e.toUint8Array(),...t??Array(32).fill(0)]));let o=n.digest(),c=(0,k.bigEndianCrc32)(o),a=new Uint8Array([...c,...o]);return(0,k.uint8ArrayToHexString)(a)};var tt=require("@dfinity/utils");var Tt=e=>{if(e.length!=64)throw new U(`Invalid account identifier ${e}. The account identifier must be 64 chars in length.`);let t=Buffer.from(e,"hex"),r=t.slice(0,4),n=Buffer.from((0,tt.bigEndianCrc32)(t.slice(4)));if(!n.equals(r))throw new U(`Account identifier ${e} has an invalid checksum. Are you sure the account identifier is correct?

Expected checksum: ${n.toString("hex")}
Found checksum: ${r.toString("hex")}`)};0&&(module.exports={AccountIdentifier,BadFeeError,IndexCanister,InsufficientFundsError,InvalidAccountIDError,InvalidSenderError,LedgerCanister,SubAccount,TransferError,TxCreatedInFutureError,TxDuplicateError,TxTooOldError,accountIdentifierFromBytes,accountIdentifierToBytes,checkAccountId,mapIcrc1TransferError,mapTransferError,mapTransferProtoError,principalToAccountIdentifier});
/*! Bundled license information:

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
//# sourceMappingURL=index.cjs.js.map
