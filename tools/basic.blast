{"cells":[{"kind":2,"language":"javascript","value":"// let ic = icblast({local:true, local_host:\"http://localhost:8080\"});\n\nlet can = await ic(\"xgnzu-riaaa-aaaal-qc64a-cai\");\nlog(me)\nglobal({can})\n"},{"kind":2,"language":"javascript","value":"let icp_ledger = await ic(\"ryjl3-tyaaa-aaaaa-aaaba-cai\");\nlog(me);\nawait icp_ledger.icrc1_balance_of({owner:me}).then(log);\n\nlet ckbtc_ledger = await ic(\"mxzaz-hqaaa-aaaar-qaada-cai\");\nawait ckbtc_ledger.icrc1_balance_of({owner:me}).then(log);\n\n\nglobal({icp_ledger, ckbtc_ledger});"},{"kind":2,"language":"javascript","value":"// ICP to BTC\nawait can.create_pipe({\n  destination:{\n    ledger:\"mxzaz-hqaaa-aaaar-qaada-cai\",\n    },\n  source:{\n    ledger:\"ryjl3-tyaaa-aaaaa-aaaba-cai\",\n    },\n  owner:me,\n  rate:{\n    max:4000,\n    provider:{xrc:{\n      destination:\"BTC\",\n      source:\"ICP\"\n      }}\n    }\n  }).then(log);\n"},{"kind":2,"language":"javascript","value":"// BTC to ICP\nawait can.create_pipe({\n    destination:{\n      ledger:\"ryjl3-tyaaa-aaaaa-aaaba-cai\",\n      },\n    source:{\n      ledger:\"mxzaz-hqaaa-aaaar-qaada-cai\",\n      },\n    owner:me,\n    rate:{\n      max:0.0004,\n      provider:{xrc:{\n        destination:\"ICP\",\n        source:\"BTC\"\n        }}\n      }\n    }).then(log);"},{"kind":2,"language":"javascript","value":"let tx = await can.get_pipe(0);\n\nlet transfer = {\n    to: tx.source.address,\n    amount: 100000\n};\n\nawait icp_ledger.icrc1_transfer(transfer).then(log);"},{"kind":2,"language":"javascript","value":"let tx = await can.get_pipe(1);\n\nlet transfer = {\n    to: tx.source.address,\n    amount: 7000\n};\n\nawait ckbtc_ledger.icrc1_transfer(transfer).then(log);"},{"kind":2,"language":"javascript","value":"\nawait can.update_pipe(0).then(log)\n"},{"kind":2,"language":"javascript","value":"await can.get_pipe(0).then(log)"},{"kind":2,"language":"javascript","value":"await can.update_pipe(1).then(log)\n"},{"kind":2,"language":"javascript","value":"await can.get_pipe(1).then(log)"},{"kind":2,"language":"javascript","value":"await can.settle_pipes(0,1).then(log)"}]}